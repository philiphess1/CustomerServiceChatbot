<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <title>Settings</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/settings.css') }}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
</head>
<body>
    <div class="top-ribbon">
        <span class="company-name">
            <a href="https://www.eccoai.org/">
                <img src="{{ url_for('static', filename='images/logoword2.png') }}" alt="Company Logo">
            </a>
        </span>
    </div>
    <div class="sidenav">
        <button class="openbtn" onclick="openNav()">&#9776;</button>
        <button class="btns" id="admin" title="Documents" onclick="openNav()"><img src="{{ url_for('static', filename='images/paper (1).png') }}" height="50" width="50" alt="Documents"></button>
        <button class="btns" id="settings" title="Settings" onclick="openNav()"><img src="{{ url_for('static', filename='images/setting (1).png') }}" height="50" width="50" alt="settings"></button>
        <button class="btns" id="integrations" title="Integrations" onclick="openNav()"><img src="{{ url_for('static', filename='images/integration (1).png') }}" height="50" width="50" alt="integration"></button>
        <button class="btns" id="analytics" title="Analytics" onclick="openNav()"><img src="{{ url_for('static', filename='images/data-analytics (1).png') }}" height="50" width="50" alt="analytics"></button>
        <button class="btns" id="usage" title="Usage" onclick="openNav()"><img src="{{ url_for('static', filename='images/usage-based-price (1).png') }}" height="50" width="50" alt="usage"></button>
    </div>
    <section id="sidepanel">
        <div id="mySidepanel" class="sidepanel">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <a href="{{ url_for('admin', chatbot_id=chatbot_id) }}" id="admin" class="mgn-top">Documents</a>
            <a href="{{ url_for('settings', chatbot_id=chatbot_id) }}" id="settings" class="mgn">Settings</a>
            <a href="{{ url_for('integrations', chatbot_id=chatbot_id) }}" id="integrations" class="mgn">Integrations</a>
            <a href="{{ url_for('analytics', chatbot_id=chatbot_id) }}" id="analytics" class="mgn">Analytics</a>
            <a href="#" id="usage">Usage</a>
        </div>
            
            
    </section>
    <div id="settings-box">

        <div id="settings-page">
            <div class="button-holder">
            <button class="button-35 selected" onclick="showPage('styling-settings')">Styling Settings</button>
            <button class="button-35" onclick="showPage('system-settings')">System Settings</button>
        </div>
            
            <div id="styling-settings" class="subpage">
                <form action="/{{ chatbot_id }}/upload_logo" method="post" enctype="multipart/form-data">
                    <label for="logo">Logo:</label>
                    <input type="file" id="logo" name="logo" accept="image/*"><br>
                    <input type="submit" value="Upload">
                </form>
                <form id="settingsForm" action="{{ url_for('update_chatbot_settings', chatbot_id=chatbot_id) }}" method="post" style="width: 2000px; height: 2000px;">
                    <div class="info-bundle">
                        <h2 class="instructions"><b>Chatbot Settings</b></h2>
                        <div class="tooltip-container">
                            <img src="{{ url_for('static', filename='images/info-button.png') }}" alt="Info" class="info-button">
                            <div class="tooltip-text">Change the settings and your system preferences below then click the save button:</div>
                        </div>   
                    </div>         
                    <div class="settings-section">
                        <h3>Styling</h3>
                        <label>Widget Icon:</label><br>
                        <img id="selected-icon" src="" alt="Selected Icon" height="150px" width="150px" value="{{ settings['widget_icon_url'] }}">
                        <br>
                        <select id="icon-select" name="icon-select" style="width: 200px;">
                            <option value="ecco_icon" data-icon="{{ url_for('static', filename='images/ecco_icon.svg') }}">Lime</option>
                            <option value="ecco_icon_black" data-icon="{{ url_for('static', filename='images/ecco_icon_black.svg') }}">Black</option>
                            <option value="ecco_icon_blue" data-icon="{{ url_for('static', filename='images/ecco_icon_blue.svg') }}">Blue</option>
                            <option value="ecco_icon_grey" data-icon="{{ url_for('static', filename='images/ecco_icon_grey.svg') }}">Grey</option>
                            <option value="ecco_icon_orange" data-icon="{{ url_for('static', filename='images/ecco_icon_orange.svg') }}">Orange</option>
                            <option value="ecco_icon_purple" data-icon="{{ url_for('static', filename='images/ecco_icon_purple.svg') }}">Purple</option>
                            <option value="ecco_icon_red" data-icon="{{ url_for('static', filename='images/ecco_icon_red.svg') }}">Red</option>
                            <option value="ecco_icon_yellow" data-icon="{{ url_for('static', filename='images/ecco_icon_yellow.svg') }}">Yellow</option>
                        </select>
                        <br>
                        <p style="margin-bottom: 50px;"></p>
        
                        <label for="background_color">Background Color:</label>
                        <input type="color" id="background_color" name="background_color" value="{{ settings['background_color'] }}"><br><br>
        
                        <label for="title_color">Title Color:</label>
                        <input type="color" id="title_color" name="title_color" value="{{ settings['title_color'] }}"><br><br>
        
                        <label for="border_color">Border Color:</label>
                        <input type="color" id="border_color" name="border_color" value="{{ settings['border_color'] }}"><br><br>
        
                        <label for="chatbot_title">Chatbot Title:</label>
                        <input type="text" id="chatbot_title" name="chatbot_title" value="{{ settings['chatbot_title'] }}" maxlength="20"><br>
                        <em><small>Must be no more than 20 characters.</small></em><br><br>

                        <label for="dot_color">Dot Color:</label>
                        <input type="color" id="dot_color" name="dot_color" value="{{ settings['dot_color'] }}"><br><br>
        
                        <label for="logo">Logo URL:</label>
                        <input type="text" id="logo" name="logo" value="{{ settings['logo'] }}"><br>
                        <em><small>Must be a valid URL. <a href="https://www.wikihow.com/Get-the-URL-for-Pictures#:~:text=Things%20You%20Should%20Know,%2C%20or%20%22Copy%20Link.%22" target="_blank">Need help?</a></small></em><br><br>
                        
                        
                        <label for="font_style">Font Style:</label>
                        <select id="font_style" name="font_style">
                            {% set font_options = ['Arial', 'Verdana', 'Times New Roman', 'Courier New', 'Georgia', 'Impact', 'Lucida Console', 'Tahoma', 'Trebuchet MS', 'Comic Sans MS', 'Palatino Linotype', 'Arial Black', 'Book Antiqua', 'Garamond', 'Courier', 'Franklin Gothic Medium', 'Copperplate', 'Century Gothic', 'Rockwell', 'Baskerville', 'Californian FB', 'Candara', 'Consolas', 'Ebrima', 'Cambria', 'MS Gothic', 'MS Mincho'] %}
                            {% for font in font_options %}
                                <option value="{{ font }}" style="font-family: '{{ font }}';" {% if settings['font_style'] == font %}selected{% endif %}>{{ font }}</option>
                            {% endfor %}
                        </select><br><br>

                        <label for="popup_message">Pop Up Message:</label><br>
                        <input type="text" id="popup_message" name="popup_message">{{ settings['popup_message'] }}</input>
                        <br><em><small>Must be no more than 50 characters.</small></em><br><br>




                        
                    </div>
                    <input type="submit" value="Save Settings">
            </div>

            <div id="system-settings" class="subpage">
                <div class="info-bundle">
                    <h2 class="instructions"><b>Chatbot Settings</b></h2>
                    <div class="tooltip-container">
                        <img src="{{ url_for('static', filename='images/info-button.png') }}" alt="Info" class="info-button">
                        <div class="tooltip-text">Change the settings and your system preferences below then click the save button:</div>
                    </div>   
                </div>  
                <div class="settings-section1">
                    <h3>System Settings</h3>
                    <label for="bot_temperature">Bot Temperature:</label>
                    <span id="bot_temperature_value">{{ settings['bot_temperature'] }}</span> <!-- Add this line -->
                    <div class="range-container"> <!-- Add this line -->
                        <span>More Accurate</span>
                        <input type="range" id="bot_temperature" name="bot_temperature" min="0" max="1" step="0.1" value="{{ settings['bot_temperature'] }}">
                        <span>More Creative</span>
                    </div><br>

                    <label for="greeting_message">Greeting Message:</label>
                    <textarea id="greeting_message" name="greeting_message" rows="4" cols="50" maxlength="500">{{ settings['greeting_message'] }}</textarea>
                    <em><small>Must be no more than 250 characters.</small></em><br><br>

                    <label for="custom_prompt">Custom Prompt:</label>
                    <textarea id="custom_prompt" name="custom_prompt" rows="4" cols="50" maxlength="1000">{{ settings['custom_prompt'] }}</textarea>
                    <em><small>Must be no more than 1000 characters.</small></em><br><br>

                    <label for="suggested_questions">Suggested questions: <br>Suggested questions to be shown to user (1 suggestion per line). Leave empty to disable.</label>
                    <textarea id="suggested_questions" name="suggested_questions" rows="4" cols="50" maxlength="500">{{ settings['suggested_questions']|join('\n') }}</textarea>
                </div>

                <input type="submit" value="Save Settings">
    
                
            </div>
            
            </form>
        </div>
        
        

            
    </div>



    <img id="chatbot-button" src="https://app.eccoai.org/static/images/{{ settings.widget_icon }}.png" alt="Chat" style="width: 80px; height: 80px; position: fixed; bottom: 10px; right: 10px; z-index: 1000; cursor: pointer; transition: transform 0.3s ease-in-out;">
    <iframe src="https://app.eccoai.org/{{ user_id }}" id="chatbot-iframe" frameborder="0" scrolling="no" width="400" height="700" style="display: none; position:fixed; bottom:93px; right:0; z-index:9999;"></iframe>
    <script>
        var chatbotButton = document.getElementById('chatbot-button');
        chatbotButton.addEventListener('mouseover', function() {
            this.style.transform = 'scale(1.1)';
        });
        chatbotButton.addEventListener('mouseout', function() {
            this.style.transform = 'scale(1)';
        });
        document.getElementById('chatbot-button').addEventListener('click', function() {
            var iframe = document.getElementById('chatbot-iframe');
            if (iframe.style.display === 'none') {
                iframe.style.display = 'block';
            } else {
                iframe.style.display = 'none';
            }
        });

        function closeChatbot() {
            var iframe = document.getElementById('chatbot-iframe');
            iframe.style.display = 'none';
        }
    </script>      
    <script src="{{ url_for('static', filename='js/settings.js') }}"></script>
</body>
</html>
