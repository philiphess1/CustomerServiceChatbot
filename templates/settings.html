<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <title>Settings</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/settings.css') }}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
</head>
<body>
    <div class="top-ribbon">
        <span class="company-name">
            <a href="https://www.eccoai.org/">
                <img src="{{ url_for('static', filename='images/logoword2.png') }}" alt="Company Logo">
            </a>
        </span>
    </div>
    <div class="sidenav">
        <button class="openbtn" onclick="openNav()">&#9776;</button>
        <button class="btns" id="admin" title="Documents" onclick="openNav()"><img src="{{ url_for('static', filename='images/paper (1).png') }}" height="50" width="50" alt="Documents"></button>
        <button class="btns" id="settings" title="Settings" onclick="openNav()"><img src="{{ url_for('static', filename='images/setting (1).png') }}" height="50" width="50" alt="settings"></button>
        <button class="btns" id="integrations" title="Integrations" onclick="openNav()"><img src="{{ url_for('static', filename='images/integration (1).png') }}" height="50" width="50" alt="integration"></button>
        <button class="btns" id="analytics" title="Analytics" onclick="openNav()"><img src="{{ url_for('static', filename='images/data-analytics (1).png') }}" height="50" width="50" alt="analytics"></button>
    </div>
    <section id="sidepanel">
        <div id="mySidepanel" class="sidepanel">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <a href="{{ url_for('admin', chatbot_id=chatbot_id) }}" id="admin" class="mgn-top">Documents</a>
            <a href="{{ url_for('settings', chatbot_id=chatbot_id) }}" id="settings" class="mgn">Settings</a>
            <a href="{{ url_for('integrations', chatbot_id=chatbot_id) }}" id="integrations" class="mgn">Integrations</a>
            <a href="{{ url_for('analytics', chatbot_id=chatbot_id) }}" id="analytics" class="mgn">Analytics</a>
        </div>
            
            
    </section>
    <div id="settings-box">

        <div id="settings-page">
            <div class="button-holder">
            <button class="button-35 selected" onclick="showPage('styling-settings')">Styling Settings</button>
            <button class="button-35" onclick="showPage('system-settings')">System Settings</button>
            <button class="button-35" onclick="showPage('faq-settings')">FAQ</button>
        </div>
        <form id="settingsForm" action="{{ url_for('update_chatbot_settings', chatbot_id=chatbot_id) }}" method="post" enctype="multipart/form-data">
            <div id="styling-settings" class="subpage">
                <div class="info-bundle">
                    <h2 class="instructions"><b>Chatbot Settings</b></h2>
                    <div class="tooltip-container">
                        <img src="{{ url_for('static', filename='images/info-button.png') }}" alt="Info" class="info-button">
                        <div class="tooltip-text">Change the settings and your system preferences below then click the save button:</div>
                    </div>   
                </div>         
                <div class="settings-container">
                    <div class="settings-section">
                        <h3>Styling</h3>
                        
                        <input type="color" id="title_color" name="title_color" value="{{ settings['title_color'] }}">
                        <label for="title_color">Title Font Color.</label>
                        <br><br>
                        
                        <input type="color" id="border_color" name="border_color" value="{{ settings['border_color'] }}">
                        <label for="border_color">Banner Backround Color.</label>
                        <br><br>

                        <input type="color" id="background_color" name="background_color" value="{{ settings['background_color'] }}">
                        <label for="background_color">Chatbot Background Color.</label>
                        <br><br>
                        
                        <input type="color" id="dot_color" name="dot_color" value="{{ settings['dot_color'] }}">
                        <label for="dot_color">Dot Animation Color.</label>
                        <br><br>
                        
                        <label for="chatbot_title">Chatbot Title:</label>
                        <input type="text" id="chatbot_title" name="chatbot_title" value="{{ settings['chatbot_title'] }}" maxlength="20"><br>
                        <em><small>Must be no more than 20 characters.</small></em><br><br>
                        
                        <label for="popup_message">Pop Up Message:</label><br>
                        <input type="text" id="popup_message" name="popup_message" value="{{ settings['popup_message'] }}">
                        <br><em><small>Must be no more than 50 characters.</small></em><br>

                    </div>
                    <div class="settings-section">
                        <h3>Branding</h3>

                        <label for="logo">Logo:</label><br>
                        <img id="currentLogo" src="{{ settings['logo'] }}" alt="Current Logo" style="width: 100px; height: 100px;">
                        <input type="file" id="logo" name="logo" accept="image/*"><br>
                        
                        <br>
                        <label for="font_style">Font Style:</label>
                        <select id="font_style" name="font_style">
                            {% set font_options = ['Arial', 'Verdana', 'Times New Roman', 'Courier New', 'Georgia', 'Impact', 'Lucida Console', 'Tahoma', 'Trebuchet MS', 'Comic Sans MS', 'Palatino Linotype', 'Arial Black', 'Book Antiqua', 'Garamond', 'Courier', 'Franklin Gothic Medium', 'Copperplate', 'Century Gothic', 'Rockwell', 'Baskerville', 'Californian FB', 'Candara', 'Consolas', 'Ebrima', 'Cambria', 'MS Gothic', 'MS Mincho'] %}
                            {% for font in font_options %}
                                <option value="{{ font }}" style="font-family: '{{ font }}';" {% if settings['font_style'] == font %}selected{% endif %}>{{ font }}</option>
                            {% endfor %}
                        </select><br><br>
                        <label>Widget Icon:</label><br>
                        <img id="selected-icon" src="{{ url_for('static', filename='images/' + settings['widget_icon']) }}" alt="Selected Icon" height="150px" width="150px">
                        <br>
                        <select id="icon-select" name="icon-select" style="width: 200px;">
                            <option value="{{settings['widget_icon']}}" selected data-icon="{{ url_for('static', filename='images/' + settings['widget_icon']) }}">Current</option>
                            <option value="ecco_icon.svg" data-icon="{{ url_for('static', filename='images/ecco_icon.svg') }}" {% if settings['widget_icon'] == url_for('static', filename='images/ecco_icon.svg') %}selected{% endif %}>Lime</option>
                            <option value="ecco_icon_black.svg" data-icon="{{ url_for('static', filename='images/ecco_icon_black.svg') }}" {% if settings['widget_icon'] == url_for('static', filename='images/ecco_icon_black.svg') %}selected{% endif %}>Black</option>
                            <option value="ecco_icon_blue.svg" data-icon="{{ url_for('static', filename='images/ecco_icon_blue.svg') }}" {% if settings['widget_icon'] == url_for('static', filename='images/ecco_icon_blue.svg') %}selected{% endif %}>Blue</option>
                            <option value="ecco_icon_grey.svg" data-icon="{{ url_for('static', filename='images/ecco_icon_grey.svg') }}" {% if settings['widget_icon'] == url_for('static', filename='images/ecco_icon_grey.svg') %}selected{% endif %}>Grey</option>
                            <option value="ecco_icon_orange.svg" data-icon="{{ url_for('static', filename='images/ecco_icon_orange.svg') }}" {% if settings['widget_icon'] == url_for('static', filename='images/ecco_icon_orange.svg') %}selected{% endif %}>Orange</option>
                            <option value="ecco_icon_purple.svg" data-icon="{{ url_for('static', filename='images/ecco_icon_purple.svg') }}" {% if settings['widget_icon'] == url_for('static', filename='images/ecco_icon_purple.svg') %}selected{% endif %}>Purple</option>
                            <option value="ecco_icon_red.svg" data-icon="{{ url_for('static', filename='images/ecco_icon_red.svg') }}" {% if settings['widget_icon'] == url_for('static', filename='images/ecco_icon_red.svg') %}selected{% endif %}>Red</option>
                            <option value="ecco_icon_yellow.svg" data-icon="{{ url_for('static', filename='images/ecco_icon_yellow.svg') }}" {% if settings['widget_icon'] == url_for('static', filename='images/ecco_icon_yellow.svg') %}selected{% endif %}>Yellow</option>
                        </select>
                    </div>
                </div> 
            </div>  
            <div id="system-settings" class="subpage">
                <div class="info-bundle">
                    <h2 class="instructions"><b>System Settings</b></h2>
                    <div class="tooltip-container">
                        <img src="{{ url_for('static', filename='images/info-button.png') }}" alt="Info" class="info-button">
                        <div class="tooltip-text">Change the settings and your system preferences below then click the save button:</div>
                    </div>   
                </div>  
                <div class="settings-section1">
                    <h3>Settings</h3>
                    <label for="bot_temperature">Bot Temperature:</label>
                    <span id="bot_temperature_value">{{ settings['bot_temperature'] }}</span> <!-- Add this line -->
                    <div class="range-container"> <!-- Add this line -->
                        <span>More Accurate</span>
                        <input type="range" id="bot_temperature" name="bot_temperature" min="0" max="1" step="0.1" value="{{ settings['bot_temperature'] }}">
                        <span>More Creative</span>
                    </div><br>

                    <label for="greeting_message">Greeting Message:</label>
                    <textarea id="greeting_message" name="greeting_message" rows="4" cols="50" maxlength="500">{{ settings['greeting_message'] }}</textarea>
                    <em><small>Must be no more than 250 characters.</small></em><br><br>

                    <label for="custom_prompt">Custom Prompt:</label>
                    <textarea id="custom_prompt" name="custom_prompt" rows="4" cols="50" maxlength="1000">{{ settings['custom_prompt'] }}</textarea>
                    <em><small>Must be no more than 1000 characters.</small></em><br><br>
                </div>
            </div>
            <div id="faq-settings" class="subpage">
                <div class="info-bundle">
                    <h2 class="instructions"><b>FAQ Settings</b></h2>
                    <div class="tooltip-container">
                        <img src="{{ url_for('static', filename='images/info-button.png') }}" alt="Info" class="info-button">
                        <div class="tooltip-text">Change the settings and your system preferences below then click the save button:</div>
                    </div>
                </div>
                <div class="settings-section1">
                    <h3>Pre-made Questions</h3>
                    <div id="premade-questions-container">
                        {% for id, question, response in premade_questions %}
                        <div class="premade-question" data-saved="true" id="question_{{ id }}">
                            <input type="hidden" name="premade_question_ids[]" value="{{ id }}">
                            <label for="premade_question_{{ loop.index }}">Question:</label>
                            <input type="text" id="premade_question_{{ loop.index }}" name="premade_questions[]" value="{{ question }}" required readonly>
                            <label for="premade_response_{{ loop.index }}">Response:</label>
                            <input type="text" id="premade_response_{{ loop.index }}" name="premade_responses[]" value="{{ response }}" required readonly>
                            <button type="button" class="delete-premade-question">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        {% endfor %}
                    </div>
                    <br>
                    <button type="button" id="add-premade-question">Add another question</button>
                </div>
            </div> 
            <input type="submit" value="Save Settings">          
        </form>
        
        

            
    </div>





    <img id="b" src="http://127.0.0.1:5000//static/images/{{ settings.widget_icon }}" alt="Chat" style="width: 80px; height: 80px; position: fixed; bottom: 10px; right: 10px; z-index: 1000; cursor: pointer; transition: transform 0.3s ease-in-out;">
    <div id="p" style="display:block;position:fixed;bottom:100px;right:15px;z-index:10000;background:#fff;border:1px solid #ccc;padding:10px;border-radius:5px;box-shadow:0 0 10px rgba(0,0,0,.1);">Welcome! How can I help you today?</div>
    <span id="c" style="display:none;position:fixed;bottom:128px;right:10px;z-index:10001;cursor:pointer;padding:2px 6px;border-radius:10px;background-color:#dadada;font-family: arial;color: #4e4e4e;">x</span>
    <iframe src="http://127.0.0.1:5000/{{ user_id }}/{{ chatbot_id }}" id="e" frameborder="0" scrolling="no" width="400" height="700" style="display: none; position:fixed; bottom:80px; right:0; z-index:9999;"></iframe>
    <script>
        var p = document.getElementById('p'), c = document.getElementById('c'), b = document.getElementById('b');
        p.onmouseover = c.onmouseover = function() { c.style.display = 'block'; };
        p.onmouseout = function() { c.style.display = 'none'; };
        c.onclick = function() { p.style.display = c.style.display = 'none'; };
        b.addEventListener('mouseover', function() {
            this.style.transform = 'scale(1.1)';
        });
        b.addEventListener('mouseout', function() {
            this.style.transform = 'scale(1)';
        });
        b.addEventListener('click', function() {
            var iframe = document.getElementById('e');
            if (iframe.style.display === 'none') {
                iframe.style.display = 'block';
                p.style.display = 'none'; // hide the 'p' element
            } else {
                iframe.style.display = 'none';
                p.style.display = 'block'; // show the 'p' element
            }
        });

        function closeChatbot() {
            var iframe = document.getElementById('e');
            iframe.style.display = 'none';
            p.style.display = 'block'; // show the 'p' element when the chatbot is closed
        }
    </script>

    
    <script src="{{ url_for('static', filename='js/settings.js') }}"></script>
</body>
</html>
